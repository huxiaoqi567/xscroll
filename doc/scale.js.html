<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: plugins/scale.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="Animate">
            <span class="title">
                <a href="Animate.html">Animate</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Animate.reset"><a href="Animate.html#reset">reset</a></li>
            
                <li data-name="Animate.run"><a href="Animate.html#run">run</a></li>
            
                <li data-name="Animate.stop"><a href="Animate.html#stop">stop</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Base">
            <span class="title">
                <a href="Base.html">Base</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Base.getPlugin"><a href="Base.html#getPlugin">getPlugin</a></li>
            
                <li data-name="Base.plug"><a href="Base.html#plug">plug</a></li>
            
                <li data-name="Base.unplug"><a href="Base.html#unplug">unplug</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Hammer">
            <span class="title">
                <a href="Hammer.html">Hammer</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Plugins">
            <span class="title">
                <a href="Plugins.html">Plugins</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Timer">
            <span class="title">
                <a href="Timer.html">Timer</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Util">
            <span class="title">
                <a href="Util.html">Util</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Util.getOffsetLeft"><a href="Util.html#getOffsetLeft">getOffsetLeft</a></li>
            
                <li data-name="Util.getOffsetTop"><a href="Util.html#getOffsetTop">getOffsetTop</a></li>
            
                <li data-name="Util.vendor"><a href="Util.html#vendor">vendor</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Util.addClass"><a href="Util.html#addClass">addClass</a></li>
            
                <li data-name="Util.findParentEl"><a href="Util.html#findParentEl">findParentEl</a></li>
            
                <li data-name="Util.guid"><a href="Util.html#guid">guid</a></li>
            
                <li data-name="Util.hasClass"><a href="Util.html#hasClass">hasClass</a></li>
            
                <li data-name="Util.isAndroid"><a href="Util.html#isAndroid">isAndroid</a></li>
            
                <li data-name="Util.isBadAndroid"><a href="Util.html#isBadAndroid">isBadAndroid</a></li>
            
                <li data-name="Util.prefixStyle"><a href="Util.html#prefixStyle">prefixStyle</a></li>
            
                <li data-name="Util.remove"><a href="Util.html#remove">remove</a></li>
            
                <li data-name="Util.removeClass"><a href="Util.html#removeClass">removeClass</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Animate">
            <span class="title">
                <a href="Animate.html">Animate</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Animate.reset"><a href="Animate.html#reset">reset</a></li>
            
                <li data-name="Animate.run"><a href="Animate.html#run">run</a></li>
            
                <li data-name="Animate.stop"><a href="Animate.html#stop">stop</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Base">
            <span class="title">
                <a href="Base.html">Base</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Base.getPlugin"><a href="Base.html#getPlugin">getPlugin</a></li>
            
                <li data-name="Base.plug"><a href="Base.html#plug">plug</a></li>
            
                <li data-name="Base.unplug"><a href="Base.html#unplug">unplug</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Infinite">
            <span class="title">
                <a href="Infinite.html">Infinite</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Infinite.pluginId"><a href="Infinite.html#pluginId">pluginId</a></li>
            
                <li data-name="Infinite.sections"><a href="Infinite.html#sections">sections</a></li>
            
                <li data-name="Infinite.visibleElements"><a href="Infinite.html#visibleElements">visibleElements</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Infinite.append"><a href="Infinite.html#append">append</a></li>
            
                <li data-name="Infinite.get"><a href="Infinite.html#get">get</a></li>
            
                <li data-name="Infinite.getVisibleElements"><a href="Infinite.html#getVisibleElements">getVisibleElements</a></li>
            
                <li data-name="Infinite.insertAfter"><a href="Infinite.html#insertAfter">insertAfter</a></li>
            
                <li data-name="Infinite.insertBefore"><a href="Infinite.html#insertBefore">insertBefore</a></li>
            
                <li data-name="Infinite.pluginDestructor"><a href="Infinite.html#pluginDestructor">pluginDestructor</a></li>
            
                <li data-name="Infinite.pluginInitializer"><a href="Infinite.html#pluginInitializer">pluginInitializer</a></li>
            
                <li data-name="Infinite.remove"><a href="Infinite.html#remove">remove</a></li>
            
                <li data-name="Infinite.render"><a href="Infinite.html#render">render</a></li>
            
                <li data-name="Infinite.replace"><a href="Infinite.html#replace">replace</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="Infinite.event:pan"><a href="Infinite.html#event:pan">pan</a></li>
            
                <li data-name="Infinite.event:panend"><a href="Infinite.html#event:panend">panend</a></li>
            
                <li data-name="Infinite.event:panstart"><a href="Infinite.html#event:panstart">panstart</a></li>
            
                <li data-name="Infinite.event:tap"><a href="Infinite.html#event:tap">tap</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="LazyLoad">
            <span class="title">
                <a href="LazyLoad.html">LazyLoad</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="LazyLoad.pluginId"><a href="LazyLoad.html#pluginId">pluginId</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="LazyLoad.pluginInitializer"><a href="LazyLoad.html#pluginInitializer">pluginInitializer</a></li>
            
                <li data-name="LazyLoad.reset"><a href="LazyLoad.html#reset">reset</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="OriginScroll">
            <span class="title">
                <a href="OriginScroll.html">OriginScroll</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="OriginScroll.getScrollLeft"><a href="OriginScroll.html#getScrollLeft">getScrollLeft</a></li>
            
                <li data-name="OriginScroll.getScrollTop"><a href="OriginScroll.html#getScrollTop">getScrollTop</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PullDown">
            <span class="title">
                <a href="PullDown.html">PullDown</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="PullDown.pluginId"><a href="PullDown.html#pluginId">pluginId</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="PullDown.pluginDestructor"><a href="PullDown.html#pluginDestructor">pluginDestructor</a></li>
            
                <li data-name="PullDown.pluginInitializer"><a href="PullDown.html#pluginInitializer">pluginInitializer</a></li>
            
                <li data-name="PullDown.render"><a href="PullDown.html#render">render</a></li>
            
                <li data-name="PullDown.reset"><a href="PullDown.html#reset">reset</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PullUp">
            <span class="title">
                <a href="PullUp.html">PullUp</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="PullUp.pluginId"><a href="PullUp.html#pluginId">pluginId</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="PullUp.complete"><a href="PullUp.html#complete">complete</a></li>
            
                <li data-name="PullUp.pluginDestructor"><a href="PullUp.html#pluginDestructor">pluginDestructor</a></li>
            
                <li data-name="PullUp.pluginInitializer"><a href="PullUp.html#pluginInitializer">pluginInitializer</a></li>
            
                <li data-name="PullUp.render"><a href="PullUp.html#render">render</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Scale">
            <span class="title">
                <a href="Scale.html">Scale</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Scale.pluginId"><a href="Scale.html#pluginId">pluginId</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Scale.pluginDestructor"><a href="Scale.html#pluginDestructor">pluginDestructor</a></li>
            
                <li data-name="Scale.pluginInitializer"><a href="Scale.html#pluginInitializer">pluginInitializer</a></li>
            
                <li data-name="Scale.scaleTo"><a href="Scale.html#scaleTo">scaleTo</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="SimuScroll">
            <span class="title">
                <a href="SimuScroll.html">SimuScroll</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="SimuScroll.boundryCheck"><a href="SimuScroll.html#boundryCheck">boundryCheck</a></li>
            
                <li data-name="SimuScroll.boundryCheckX"><a href="SimuScroll.html#boundryCheckX">boundryCheckX</a></li>
            
                <li data-name="SimuScroll.boundryCheckY"><a href="SimuScroll.html#boundryCheckY">boundryCheckY</a></li>
            
                <li data-name="SimuScroll.computeScroll"><a href="SimuScroll.html#computeScroll">computeScroll</a></li>
            
                <li data-name="SimuScroll.destroyScrollBars"><a href="SimuScroll.html#destroyScrollBars">destroyScrollBars</a></li>
            
                <li data-name="SimuScroll.getBoundryOutBottom"><a href="SimuScroll.html#getBoundryOutBottom">getBoundryOutBottom</a></li>
            
                <li data-name="SimuScroll.getBoundryOutLeft"><a href="SimuScroll.html#getBoundryOutLeft">getBoundryOutLeft</a></li>
            
                <li data-name="SimuScroll.getBoundryOutRight"><a href="SimuScroll.html#getBoundryOutRight">getBoundryOutRight</a></li>
            
                <li data-name="SimuScroll.getBoundryOutTop"><a href="SimuScroll.html#getBoundryOutTop">getBoundryOutTop</a></li>
            
                <li data-name="SimuScroll.getScrollLeft"><a href="SimuScroll.html#getScrollLeft">getScrollLeft</a></li>
            
                <li data-name="SimuScroll.getScrollTop"><a href="SimuScroll.html#getScrollTop">getScrollTop</a></li>
            
                <li data-name="SimuScroll.init"><a href="SimuScroll.html#init">init</a></li>
            
                <li data-name="SimuScroll.initController"><a href="SimuScroll.html#initController">initController</a></li>
            
                <li data-name="SimuScroll.initScrollBars"><a href="SimuScroll.html#initScrollBars">initScrollBars</a></li>
            
                <li data-name="SimuScroll.isBoundryOut"><a href="SimuScroll.html#isBoundryOut">isBoundryOut</a></li>
            
                <li data-name="SimuScroll.isBoundryOutBottom"><a href="SimuScroll.html#isBoundryOutBottom">isBoundryOutBottom</a></li>
            
                <li data-name="SimuScroll.isBoundryOutLeft"><a href="SimuScroll.html#isBoundryOutLeft">isBoundryOutLeft</a></li>
            
                <li data-name="SimuScroll.isBoundryOutRight"><a href="SimuScroll.html#isBoundryOutRight">isBoundryOutRight</a></li>
            
                <li data-name="SimuScroll.isBoundryOutTop"><a href="SimuScroll.html#isBoundryOutTop">isBoundryOutTop</a></li>
            
                <li data-name="SimuScroll.render"><a href="SimuScroll.html#render">render</a></li>
            
                <li data-name="SimuScroll.scrollLeft"><a href="SimuScroll.html#scrollLeft">scrollLeft</a></li>
            
                <li data-name="SimuScroll.scrollLeft"><a href="SimuScroll.html#scrollLeft">scrollLeft</a></li>
            
                <li data-name="SimuScroll.scrollTop"><a href="SimuScroll.html#scrollTop">scrollTop</a></li>
            
                <li data-name="SimuScroll.scrollTop"><a href="SimuScroll.html#scrollTop">scrollTop</a></li>
            
                <li data-name="SimuScroll.stop"><a href="SimuScroll.html#stop">stop</a></li>
            
                <li data-name="SimuScroll.translate"><a href="SimuScroll.html#translate">translate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Snap">
            <span class="title">
                <a href="Snap.html">Snap</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Snap.pluginId"><a href="Snap.html#pluginId">pluginId</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Snap.pluginDestructor"><a href="Snap.html#pluginDestructor">pluginDestructor</a></li>
            
                <li data-name="Snap.pluginInitializer"><a href="Snap.html#pluginInitializer">pluginInitializer</a></li>
            
                <li data-name="Snap.render"><a href="Snap.html#render">render</a></li>
            
                <li data-name="Snap.snapTo"><a href="Snap.html#snapTo">snapTo</a></li>
            
                <li data-name="Snap.snapToCol"><a href="Snap.html#snapToCol">snapToCol</a></li>
            
                <li data-name="Snap.snapToRow"><a href="Snap.html#snapToRow">snapToRow</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="XScroll">
            <span class="title">
                <a href="XScroll.html">XScroll</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="XScroll.version"><a href="XScroll.html#version">version</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="XScroll.boundryCheck"><a href="XScroll.html#boundryCheck">boundryCheck</a></li>
            
                <li data-name="XScroll.boundryCheckX"><a href="XScroll.html#boundryCheckX">boundryCheckX</a></li>
            
                <li data-name="XScroll.boundryCheckY"><a href="XScroll.html#boundryCheckY">boundryCheckY</a></li>
            
                <li data-name="XScroll.destroy"><a href="XScroll.html#destroy">destroy</a></li>
            
                <li data-name="XScroll.disableGPUAcceleration"><a href="XScroll.html#disableGPUAcceleration">disableGPUAcceleration</a></li>
            
                <li data-name="XScroll.enableGPUAcceleration"><a href="XScroll.html#enableGPUAcceleration">enableGPUAcceleration</a></li>
            
                <li data-name="XScroll.getScrollLeft"><a href="XScroll.html#getScrollLeft">getScrollLeft</a></li>
            
                <li data-name="XScroll.getScrollPos"><a href="XScroll.html#getScrollPos">getScrollPos</a></li>
            
                <li data-name="XScroll.getScrollTop"><a href="XScroll.html#getScrollTop">getScrollTop</a></li>
            
                <li data-name="XScroll.init"><a href="XScroll.html#init">init</a></li>
            
                <li data-name="XScroll.initTouchAction"><a href="XScroll.html#initTouchAction">initTouchAction</a></li>
            
                <li data-name="XScroll.render"><a href="XScroll.html#render">render</a></li>
            
                <li data-name="XScroll.resetSize"><a href="XScroll.html#resetSize">resetSize</a></li>
            
                <li data-name="XScroll.scrollBy"><a href="XScroll.html#scrollBy">scrollBy</a></li>
            
                <li data-name="XScroll.scrollLeft"><a href="XScroll.html#scrollLeft">scrollLeft</a></li>
            
                <li data-name="XScroll.scrollLeftBy"><a href="XScroll.html#scrollLeftBy">scrollLeftBy</a></li>
            
                <li data-name="XScroll.scrollTo"><a href="XScroll.html#scrollTo">scrollTo</a></li>
            
                <li data-name="XScroll.scrollTop"><a href="XScroll.html#scrollTop">scrollTop</a></li>
            
                <li data-name="XScroll.scrollTopBy"><a href="XScroll.html#scrollTopBy">scrollTopBy</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="XScrollMaster">
            <span class="title">
                <a href="XScrollMaster.html">XScrollMaster</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="XScrollMaster.get"><a href="XScrollMaster.html#get">get</a></li>
            
                <li data-name="XScrollMaster.init"><a href="XScrollMaster.html#init">init</a></li>
            
                <li data-name="XScrollMaster.render"><a href="XScrollMaster.html#render">render</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="scale.js.html">Source: plugins/scale.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source "><code>"use strict";
var Util = require('../util'),
	Base = require('../base');
// reduced scale rate
var SCALE_RATE = 0.7;
var SCALE_TO_DURATION = 300;
/**
 * A scalable plugin for xscroll.
 * @constructor
 * @param {object} cfg
 * @param {number} cfg.minScale min value for scale
 * @param {number} cfg.maxScale max value for scale
 * @param {number} cfg.duration duration for scale animation
 * @extends {Base}
 */
var Scale = function(cfg) {
	Scale.superclass.constructor.call(this, cfg);
	this.userConfig = Util.mix({
		minScale: 1,
		maxScale: 2,
		duration: SCALE_TO_DURATION
	}, cfg);
}

Util.extend(Scale, Base, {
	/**
	 * a pluginId
	 * @memberOf Scale
	 * @type {string}
	 */
	pluginId: "scale",
	/**
	 * plugin initializer
	 * @memberOf Scale
	 * @override Scale
	 * @return {Infinite}
	 */
	pluginInitializer: function(xscroll) {
		var self = this;
		self.scale = 1;
		self.xscroll = xscroll.render();
		self.initialContainerWidth = xscroll.containerWidth;
		self.initialContainerHeight = xscroll.containerHeight;
		self.minScale = self.userConfig.minScale || Math.max(xscroll.width / xscroll.containerWidth, xscroll.height / xscroll.containerHeight);
		self.maxScale = self.userConfig.maxScale || 1;
		self._bindEvt();
		return self;
	},
	/**
	 * detroy the plugin
	 * @memberOf Scale
	 * @override Base
	 * @return {Scale}
	 */
	pluginDestructor: function() {
		var self = this;
		var xscroll = self.xscroll;
		xscroll.off("doubletap", self._doubleTapHandler, self);
		xscroll.off("pinchstart", self._pinchStartHandler, self);
		xscroll.off("pinchmove", self._pinchHandler, self);
		xscroll.off("pinchend pinchcancel", self._pinchEndHandler, self);
		return self;
	},
	_doubleTapHandler: function(e) {
		var self = this;
		var xscroll = self.xscroll;
		var minScale = self.userConfig.minScale;
		var maxScale = self.userConfig.maxScale;
		var duration = self.userConfig.duration;
		self.originX = (e.center.x - xscroll.x) / xscroll.containerWidth;
		self.originY = (e.center.y - xscroll.y) / xscroll.containerHeight;
		xscroll.scale > self.minScale ? self.scaleTo(minScale, self.originX, self.originY, duration) : self.scaleTo(maxScale, self.originX, self.originY, duration);
		return self;
	},
	_pinchStartHandler: function(e) {
		var self = this;
		var xscroll = self.xscroll;
		//disable pan gesture
		self.disablePan();
		xscroll.stop();
		self.isScaling = false;
		self.scale = xscroll.scale;
		self.originX = (e.center.x - xscroll.x) / xscroll.containerWidth;
		self.originY = (e.center.y - xscroll.y) / xscroll.containerHeight;
	},
	_pinchHandler: function(e) {
		var self = this;
		var scale = self.scale;
		var xscroll = self.xscroll;
		var originX = self.originX;
		var originY = self.originY;
		var __scale = scale * e.scale;
		if (__scale &lt;= self.userConfig.minScale) {
			// s = 1/2 * a * 2^(s/a)
			__scale = 0.5 * self.userConfig.minScale * Math.pow(2, __scale / self.userConfig.minScale);
		}
		if (__scale >= self.userConfig.maxScale) {
			// s = 2 * a * 1/2^(a/s)
			__scale = 2 * self.userConfig.maxScale * Math.pow(0.5, self.userConfig.maxScale / __scale);
		}
		self._scale(__scale, originX, originY);
		self.xscroll.translate(xscroll.x, xscroll.y, __scale, 'e.scale', e.scale);
	},
	disablePan: function() {
		this.xscroll.mc.get("pan").set({
			enable: false
		});
		return this;
	},
	enablePan: function() {
		this.xscroll.mc.get("pan").set({
			enable: true
		});
		return this;
	},
	_pinchEndHandler: function(e) {
		var self = this;
		var originX = self.originX;
		var originY = self.originY;
		var xscroll = self.xscroll;
		if (xscroll.scale &lt; self.minScale) {
			self.scaleTo(self.minScale, originX, originY, SCALE_TO_DURATION, "ease-out", self.enablePan);
		} else if (xscroll.scale > self.maxScale) {
			self.scaleTo(self.maxScale, originX, originY, SCALE_TO_DURATION, "ease-out", self.enablePan);
		} else {
			self.enablePan();
		}
	},
	_bindEvt: function() {
		var self = this;
		var xscroll = self.xscroll;
		xscroll.on("doubletap", self._doubleTapHandler, self);
		xscroll.on("pinchstart", self._pinchStartHandler, self);
		xscroll.on("pinchmove", self._pinchHandler, self);
		xscroll.on("pinchend pinchcancel", self._pinchEndHandler, self);
		return self;
	},
	_scale: function(scale, originX, originY) {
		var self = this;
		var xscroll = self.xscroll;
		var boundry = self.xscroll.boundry;
		if (xscroll.scale == scale || !scale) return;
		if (!self.isScaling) {
			self.scaleBegin = xscroll.scale;
			self.isScaling = true;
			self.scaleBeginX = xscroll.x;
			self.scaleBeginY = xscroll.y;
		}
		if (originX) {
			self.originX = originX;
		}
		if (originY) {
			self.originY = originY;
		}
		var containerWidth = scale * self.initialContainerWidth;
		var containerHeight = scale * self.initialContainerHeight;
		xscroll.containerWidth = Math.round(containerWidth > xscroll.width ? containerWidth : xscroll.width);
		xscroll.containerHeight = Math.round(containerHeight > xscroll.height ? containerHeight : xscroll.height);
		xscroll.scale = scale;
		var x = originX * (self.initialContainerWidth * self.scaleBegin - xscroll.containerWidth) + self.scaleBeginX;
		var y = originY * (self.initialContainerHeight * self.scaleBegin - xscroll.containerHeight) + self.scaleBeginY;
		if (x > boundry.left) {
			x = boundry.left;
		}
		if (y > boundry.top) {
			y = boundry.top;
		}
		if (x &lt; boundry.right - xscroll.containerWidth) {
			x = boundry.right - xscroll.containerWidth;
		}
		if (y &lt; boundry.bottom - xscroll.containerHeight) {
			y = boundry.bottom - xscroll.containerHeight;
		}
		xscroll.x = x;
		xscroll.y = y;
	},
	/**
	 * scale with an animation
	 * @memberOf Scale
	 * @param {number} scale
	 * @param {number} originX 0~1
	 * @param {number} originY 0~1
	 * @param {number} duration
	 * @param {string} easing
	 * @param {function} callback
	 */
	scaleTo: function(scale, originX, originY, duration, easing, callback) {
		var self = this;
		var xscroll = self.xscroll;
		//unscalable
		if (xscroll.scale == scale || !scale) return;
		var duration = duration || SCALE_TO_DURATION;
		var easing = easing || "ease-out";
		self.scaleStart = xscroll.scale || 1;
		// transitionStr = [transformStr, " ", duration , "s ", easing, " 0s"].join("");
		self._scale(scale, originX, originY);
		xscroll._animate("x", "translateX(" + xscroll.x + "px) scale(" + scale + ")", duration, easing, function(e) {
			callback && callback.call(self, e);
		});
		xscroll._animate("y", "translateY(" + xscroll.y + "px)", duration, easing, function(e) {
			callback && callback.call(self, e);
		});
		xscroll.__timers.x.timer.off("run", self.scaleHandler, self);
		xscroll.__timers.x.timer.off("stop", self.scaleendHandler, self);
		self.scaleHandler = function(e) {
			var _scale = (scale - self.scaleStart) * e.percent + self.scaleStart;
			//trigger scroll event
			self.trigger("scale", {
				scale: _scale,
				origin: {
					x: originX,
					y: originY
				}
			});
		};

		self.scaleendHandler = function(e) {
			self.isScaling = false;
			//enable pan gesture
			self.enablePan();
			self.trigger("scaleend", {
				type: "scaleend",
				scale: self.scale,
				origin: {
					x: originX,
					y: originY
				}
			})
		}
		
		xscroll.__timers.x.timer.on("run", self.scaleHandler, self);
		xscroll.__timers.x.timer.on("stop", self.scaleendHandler, self);
		self.trigger("scaleanimate", {
			type:"scaleanimate",
			scale: xscroll.scale,
			duration: duration,
			easing: easing,
			offset: {
				x: xscroll.x,
				y: xscroll.y
			},
			origin: {
				x: originX,
				y: originY
			}
		});
	}
});

if (typeof module == 'object' && module.exports) {
	module.exports = Scale;
}
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Thu Oct 29 2015 16:47:25 GMT+0800 (CST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
